(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{380162:e=>{"use strict";e.s({default:()=>t});let t=(0,e.i(238959).default)("sparkle",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}]])},856951:e=>{"use strict";e.s({Sparkle:()=>t.default});var t=e.i(380162)},157633:e=>{"use strict";e.s({AlertTriangle:()=>t.default});var t=e.i(656908)},184106:e=>{"use strict";e.s({default:()=>c});var t=e.i(11968),r=e.i(290479),a=e.i(157633),s=e.i(909210),n=e.i(373150),i=e.i(972899);class l extends n.default.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("SearchErrorBoundary caught an error:",e,t)}render(){if(this.state.hasError){let e=this.props.fallback||o;return(0,r.jsx)(e,{error:this.state.error,resetError:this.resetError})}return this.props.children}constructor(e){super(e),(0,t._)(this,"resetError",()=>{this.setState({hasError:!1,error:void 0})}),this.state={hasError:!1}}}let o=e=>{let{error:t,resetError:n}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-10 text-center bg-red-50 rounded-4 border border-red-200",children:[(0,r.jsx)(i.Icon,{as:a.AlertTriangle,className:"w-15 h-15 text-red mb-7"}),(0,r.jsx)("p",{className:"text-sm text-red mb-7 max-w-md",children:(null==t?void 0:t.message)||"An unexpected error occurred while searching. Please try again."}),(0,r.jsxs)("button",{onClick:n,className:"inline-flex items-center px-7 py-4 bg-red text-white rounded-4 hover:bg-red transition-colors",children:[(0,r.jsx)(i.Icon,{as:s.RefreshCw,className:"w-7 h-7 mr-4"}),"Try Again"]})]})},c=l},989252:e=>{"use strict";e.s({default:()=>i});var t=e.i(290479),r=e.i(373150),a=e.i(998145);e.i(567349);var s=e.i(111367),n=e.i(972899);let i=(0,r.memo)(e=>{let{chatbots:r,forceMount:i,heading:l,onSelectChatbot:o}=e;return 0===r.length?null:(0,t.jsx)(s.CommandGroup,{forceMount:i,heading:l,children:r.map(e=>{var r;return(0,t.jsxs)(s.CommandItem,{keywords:[e.type],value:"".concat(e.name,"-").concat(e.id),onSelect:()=>o(e.id),children:[(0,t.jsx)(n.Icon,{className:"flex-shrink-0 text-text-secondary",as:(0,a.default)({type:e.type})}),(0,t.jsx)("span",{className:"line-clamp-1",children:null!=(r=e.name)?r:"Untitled"})]},e.id)})})})},681052:e=>{"use strict";e.s({default:()=>c});var t=e.i(290479),r=e.i(252390),a=e.i(282979),s=e.i(373150),n=e.i(834799);e.i(567349);var i=e.i(111367),l=e.i(972899),o=e.i(626388);let c=()=>{let[e,c]=(0,o.useSearchMenu)(),{track:d}=(0,r.default)(),u=(0,s.useRef)(null),{processFiles:m}=(0,n.default)();return(0,t.jsxs)(i.CommandItem,{value:"Upload file",onSelect:()=>{d("search_import"),u.current&&setTimeout(()=>{var e;null==(e=u.current)||e.click()},50)},children:[(0,t.jsx)("input",{id:"file-input-search-menu",type:"file",ref:u,className:"hidden",multiple:!0,accept:n.SUPPORTED_EXTENSIONS.join(","),onChange:e=>{let t=e.target.files;t&&t.length>0&&(c(!1),m(Array.from(t)),e.target.value="")},onClick:e=>e.stopPropagation()}),(0,t.jsxs)("div",{className:"flex gap-4 items-center w-full pointer-events-none",children:[(0,t.jsx)(l.Icon,{as:a.Upload}),"Upload file"]})]})}},209045:e=>{"use strict";e.s({NewSearchMenuContent:()=>P,default:()=>_});var t=e.i(290479),r=e.i(373150),a=e.i(663018),s=e.i(885905),n=e.i(574650),i=e.i(279194),l=e.i(950347),o=e.i(461655),c=e.i(449097),d=e.i(252390),u=e.i(60145),m=e.i(289702),h=e.i(149404),x=e.i(578018),p=e.i(856951),f=e.i(257140),g=e.i(397711),y=e.i(525094),j=e.i(55579),b=e.i(450807);e.i(567349);var v=e.i(111367),C=e.i(457443),N=e.i(972899),w=e.i(184106),S=e.i(989252),k=e.i(681052),A=e.i(626388);let E=r.memo(()=>(0,t.jsx)("div",{className:"space-y-4 px-3 py-4",children:Array.from({length:4}).map(()=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-[14px] h-[14px] bg-text-tertiary rounded-4 animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("div",{className:"h-7 bg-text-tertiary rounded-4 w-1/2 animate-pulse"}),(0,t.jsx)("div",{className:"h-6 bg-text-tertiary rounded-4 w-[15%] animate-pulse"})]})]},(0,f.nanoid)()))})),I=r.memo(()=>(0,t.jsx)(v.CommandGroup,{heading:"Library",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:[(0,t.jsx)(N.Icon,{as:x.FilePen,className:"w-10 h-10 text-text-secondary"}),(0,t.jsx)("h3",{className:"text-base font-medium text-text-primary mt-7",children:"No items found"}),(0,t.jsx)("p",{className:"text-sm text-text-secondary",children:"Try a different search term or create your first note."})]})})),L=r.memo(e=>{let{type:r,onAskAI:a,onCreateNote:s,input:n}=e;return(0,t.jsxs)(v.CommandGroup,{heading:"Actions",children:[(0,t.jsxs)(v.CommandItem,{value:"unriddle-ai-question",onSelect:a,children:[(0,t.jsx)(N.Icon,{as:p.Sparkle,className:"text-text-secondary"}),n.trim()?'Ask AI: "'.concat(n.trim(),'"'):"Ask AI..."]}),"dialog"===r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(v.CommandItem,{onSelect:s,children:[(0,t.jsx)(N.Icon,{as:x.FilePen,className:"text-text-secondary"}),"Create note"]}),(0,t.jsx)(k.default,{})]})]})}),T=r.memo(e=>{let{type:s,onAskAI:n,onCreateNote:i,chatbots:l,onSelectChatbot:o,isLoading:c,hasNextPage:d,isFetchingNextPage:u,fetchNextPage:m,input:h}=e,x=r.useRef(null),p=r.useRef(null),f=r.useRef(null),g=r.useCallback(e=>{"ArrowDown"===e.key&&d&&!u&&m&&setTimeout(()=>{let e=x.current;if(e){let t=document.activeElement,r=e.querySelectorAll("[cmdk-item]");r.length>0&&t===r[r.length-1]&&m()}},0)},[d,u,m]);r.useEffect(()=>{var e;if(f.current&&d&&!u)return p.current&&p.current.disconnect(),p.current=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting&&d&&!u&&m&&m()},{root:null!=(e=x.current)?e:null,rootMargin:"100px",threshold:.1}),p.current.observe(f.current),()=>{p.current&&p.current.disconnect()}},[d,u,m]),r.useEffect(()=>{let e=x.current;e&&d&&!u&&m&&(async()=>{let t=0;for(;t<5&&e.scrollHeight<=e.clientHeight+4&&d&&!u;)await m(),t+=1})()},[l.length,d,u,m]);let y=r.useCallback(()=>{let e=x.current;e&&d&&!u&&m&&e.scrollTop+e.clientHeight>=e.scrollHeight-200&&m()},[d,u,m]);return r.useEffect(()=>()=>{p.current&&p.current.disconnect()},[]),(0,t.jsxs)(v.CommandList,{ref:x,onKeyDown:g,onScroll:y,className:"max-h-[400px] scrollbar-hide bg-background-primary overflow-y-auto",children:[(0,t.jsx)(L,{type:s,onAskAI:n,onCreateNote:i,input:h}),c?(0,t.jsx)(v.CommandGroup,{heading:"Library",children:(0,t.jsx)(E,{})}):0===l.length?(0,t.jsx)(I,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.default,{chatbots:l,heading:"Library",onSelectChatbot:o}),d&&(0,t.jsx)("div",{ref:f,className:"h-2 w-full","aria-hidden":"true"}),u&&(0,t.jsx)(v.CommandGroup,{children:(0,t.jsxs)("div",{className:"flex items-center justify-center p-7",children:[(0,t.jsx)(a.LoadingSpinner,{variant:"small"}),(0,t.jsx)("span",{className:"ml-4 text-sm text-text-secondary",children:"Loading more..."})]})})]})]})}),D=r.memo(e=>{let{value:r,onChange:a}=e;return(0,t.jsx)("div",{className:(0,m.cn)("flex gap-2 items-center w-full h-[53px] border-b bg-background-primary","p-7"),children:(0,t.jsx)(h.CommandInput,{value:r,onValueChange:a,className:"text-sm w-full placeholder:text-text-secondary text-text-primary bg-transparent focus-visible:outline-none font-medium",placeholder:"Search your library..."})})}),P=r.memo(e=>{let{type:a}=e,[m,h]=r.useState(""),[x,p]=r.useState(""),v=r.useRef(m),{track:C}=(0,d.default)(),N=(0,g.useRouter)(),[w,S]=(0,A.useSearchMenu)(),{user:k}=(0,s.useAuth)(),{exceededLimits:E,isFreePlan:I}=(0,l.default)(),{showUpgrade:L}=(0,b.useUpgrade)(),{settings:P}=(0,c.useSettings)(),{createChat:M}=(0,j.useCreateChat)(),{createNote:_}=(0,o.default)({onSuccess:e=>{e&&N.push("/b/".concat(e.id))}}),R=(0,n.useDebouncedCallback)(p,500);r.useEffect(()=>{v.current!==m&&(v.current=m)},[m]);let{results:F,isLoading:H,hasNextPage:U,isFetchingNextPage:O,fetchNextPage:q}=(0,i.useLibrarySearch)({searchQuery:x,enabled:!0}),G=r.useMemo(()=>{let e=F||[],t=new Set;return[...e.filter(e=>!t.has(e.id)&&(t.add(e.id),!0)).filter(e=>"CHAT"!==e.type)].sort((e,t)=>{let r=(null==e?void 0:e.createdAt)instanceof Date?e.createdAt.getTime():new Date(null==e?void 0:e.createdAt).getTime()||0;return((null==t?void 0:t.createdAt)instanceof Date?t.createdAt.getTime():new Date(null==t?void 0:t.createdAt).getTime()||0)-r})},[F]),K=(0,u.usePendingMessageStore)(),B=r.useCallback(e=>{h(e),R(e)},[R]),W=r.useCallback(e=>{C("search_chatbot_selected"),N.push("/b/".concat(e)),S(!1)},[C,N,S]),z=r.useCallback(async()=>{if(I&&(null==E?void 0:E.isWordCountLimitExceeded)){L("messageLimit"),C("wordCountLimitHit",{userId:null==k?void 0:k.id,modelName:P.modelName}),C("Paywall Shown",{reason:"Word Count Limit Hit",type:"Message"});return}if(m.trim().length<1)return y.toast.error("Please enter a question");C("search_ai_message",{question:m.trim()});let{id:e}=await M({id:(0,f.nanoid)(),includedSources:[{type:"library"}]});K.set(e,{text:m.trim()}),N.push("/b/".concat(e,"?model=").concat(P.modelName,"&maxLength=").concat(P.maxLength,"&pendingMessage=true")),S(!1),C("chat_nothing_created",{chatbotId:e,query:m.trim(),model:P.modelName,maxLength:P.maxLength,context:"library"})},[I,null==E?void 0:E.isWordCountLimitExceeded,P.modelName,P.maxLength,null==k?void 0:k.id,null==k?void 0:k.teamsMemberOf,L,C,M,K,m,N,S]),V=r.useCallback(()=>{S(!1),C("search_create_note"),y.toast.promise(_(),{loading:"Creating note",error:"Error creating note"})},[S,C,_]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{value:m,onChange:B}),(0,t.jsx)(T,{type:a,onAskAI:z,onCreateNote:V,chatbots:G,onSelectChatbot:W,isLoading:H,hasNextPage:U,isFetchingNextPage:O,fetchNextPage:q,input:m})]})}),M=()=>1,_=e=>{let{type:a}=e,[s,n]=(0,A.useSearchMenu)(),{track:i}=(0,d.default)();r.useEffect(()=>{let e=e=>{"k"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),i("search_menu_shortcut"),n(!0))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i,n]);let l=r.useMemo(()=>(0,t.jsx)(w.default,{children:(0,t.jsx)(P,{type:a})}),[a]);return"content"===a?(0,t.jsx)(v.Command,{filter:M,shouldFilter:!1,className:"border border-border-primary rounded-6 h-[400px] shadow-feint gap-0 bg-background-primary",children:l}):(0,t.jsxs)(C.Dialog,{open:s,onOpenChange:n,children:[(0,t.jsxs)(C.DialogHeader,{className:"sr-only",children:[(0,t.jsx)(C.DialogTitle,{children:"Search menu"}),(0,t.jsx)(C.DialogDescription,{children:"Search your library for information and easily create notes."})]}),(0,t.jsx)(C.DialogContent,{hideCloseButton:!0,className:"rounded-6 h-[400px] shadow-feint max-w-[640px] w-full p-0 overflow-hidden bg-popover",children:(0,t.jsx)(v.Command,{filter:M,shouldFilter:!1,className:"gap-0 bg-background-primary",children:l})})]})}},236414:e=>{e.n(e.i(209045))}}]);

//# sourceMappingURL=d9360cfc8e2befa3.js.map