(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{843642:e=>{"use strict";e.s({HelpCircle:()=>t.default});var t=e.i(84080)},670087:e=>{"use strict";e.s({useSpring:()=>o});var t=e.i(599198),r=e.i(73145),i=e.i(373150),a=e.i(675326),n=e.i(520668),s=e.i(162109);function o(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isStatic:l}=(0,i.useContext)(a.MotionConfigContext),c=()=>(0,r.isMotionValue)(e)?e.get():e;if(l)return(0,s.useTransform)(c);let u=(0,n.useMotionValue)(c());return(0,i.useInsertionEffect)(()=>(0,t.attachSpring)(u,e,o),[u,JSON.stringify(o)]),u}},734981:e=>{"use strict";e.s({VanishText:()=>n});var t=e.i(290479),r=e.i(289702),i=e.i(34818),a=e.i(373150);function n(e){let{children:n,className:s,onVanishComplete:o,trigger:l,variant:c="particles"}=e,u=(0,a.useRef)(null),d=(0,a.useRef)(null),m=(0,a.useRef)([]),[p,h]=(0,a.useState)(!1),f=(0,a.useCallback)(()=>{if(!d.current)return;let e=u.current;if(!e)return;let t=e.getContext("2d");if(!t)return;e.width=800,e.height=800,t.clearRect(0,0,800,800);let r=getComputedStyle(d.current),i=Number.parseFloat(r.getPropertyValue("font-size"));t.font="".concat(2*i,"px ").concat(r.fontFamily),t.fillStyle="#FFF",t.fillText(n,16,40);let a=t.getImageData(0,0,800,800).data,s=[];for(let e=0;e<800;e++){let t=4*e*800;for(let r=0;r<800;r++){let i=t+4*r;0!==a[i]&&0!==a[i+1]&&0!==a[i+2]&&s.push({x:r,y:e,color:[a[i],a[i+1],a[i+2],a[i+3]]})}}m.current=s.map(e=>{let{x:t,y:r,color:i}=e;return{x:t,y:r,r:1,color:"rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", ").concat(i[3],")")}})},[n]),g=(0,a.useCallback)(e=>{let t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(()=>{var r;let i=[];for(let t=0;t<m.current.length;t++){let r=m.current[t];if(r.x<e)i.push(r);else{if(r.r<=0){r.r=0;continue}r.x+=Math.random()>.5?1:-1,r.y+=Math.random()>.5?1:-1,r.r-=.05*Math.random(),i.push(r)}}m.current=i;let a=null==(r=u.current)?void 0:r.getContext("2d");if(a)for(let t of(a.clearRect(e,0,800,800),m.current)){let{x:r,y:i,r:n,color:s}=t;r>e&&(a.beginPath(),a.rect(r,i,n,n),a.fillStyle=s,a.strokeStyle=s,a.stroke())}m.current.length>0?t(e-8):(h(!1),null==o||o())})};t(e)},[o]),x=(0,a.useCallback)(()=>{!p&&(h(!0),"blur"===c?setTimeout(()=>{h(!1),null==o||o()},2e3):(f(),n&&d.current&&g(m.current.reduce((e,t)=>t.x>e?t.x:e,0))))},[p,f,g,n,c,o]);return(0,a.useEffect)(()=>{l&&x()},[l,x]),(0,t.jsxs)("div",{className:"relative inline-block",children:["particles"===c&&(0,t.jsx)("canvas",{className:(0,r.cn)("absolute pointer-events-none text-base transform scale-50 top-0 left-0 origin-top-left filter invert dark:invert-0 -mt-[5px] -ml-3",p?"opacity-100":"opacity-0"),ref:u}),(0,t.jsx)(i.motion.p,{ref:d,className:(0,r.cn)("relative","particles"===c&&p&&"invisible",s),animate:"blur"===c&&p?{opacity:0,scale:.9,y:-10,filter:"blur(6px)"}:{opacity:1,scale:1,y:0,filter:"blur(0px)"},transition:{duration:2,ease:"easeOut"},children:n})]})}},479542:e=>{"use strict";e.s({}),e.i(734981)},330807:e=>{"use strict";e.s({}),e.i(734981),e.i(479542)},374943:e=>{"use strict";e.s({Checkbox:()=>d});var t=e.i(290479),r=e.i(289702),i=e.i(184901),a=e.i(843642),n=e.i(334145),s=e.i(34818),o=e.i(670087),l=e.i(373150);e.i(330807);var c=e.i(734981),u=e.i(972899);function d(e){let{label:d="Add a file",initialChecked:m=!1,showLearnHow:p=!1,onLearnHowClick:h,readOnly:f=!1,onZoteroDismissStart:g,onZoteroDismissComplete:x}=e,[w,y]=l.default.useState(m),v=(0,o.useSpring)(0,{stiffness:300,damping:30});l.default.useEffect(()=>{f&&y(m)},[m,f]),l.default.useEffect(()=>{let e=[];return w?(e.push(window.setTimeout(()=>{v.set(-4)},400)),e.push(window.setTimeout(()=>{v.set(0)},550))):v.set(0),()=>{e.forEach(clearTimeout)}},[w]);let b=d.startsWith("Connect Zotero"),[C,S]=l.default.useState(!1);return(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)("div",{className:"w-full flex items-center justify-between group transition-[background] ease-in-out duration-0 hover:bg-popover-hover p-4 rounded-6 relative",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 relative flex-1 min-w-0",children:[b&&(0,t.jsx)("button",{onClick:()=>{S(!0),null==g||g()},className:"absolute top-0 left-0  items-center justify-center  h-full hidden group-hover:flex",children:(0,t.jsx)(u.Icon,{as:n.X,className:"!w-7 !h-7 text-text-secondary"})}),(0,t.jsx)("div",{className:"checkbox flex-shrink-0","data-checked":w,children:(0,t.jsx)("svg",{viewBox:"0 0 21 21",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"M5,10.75 L8.5,14.25 L19.4,2.3 C18.8333333,1.43333333 18.0333333,1 17,1 L4,1 C2.35,1 1,2.35 1,4 L1,17 C1,18.65 2.35,20 4,20 L17,20 C18.65,20 20,18.65 20,17 L20,7.99769186"})})}),(0,t.jsx)(s.motion.div,{className:"relative flex items-center gap-2",style:{x:v},children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(c.VanishText,{className:(0,r.cn)("text-sm text-text-primary transition-all duration-300",w&&"line-through decoration-text-primary decoration-2"),variant:"blur",trigger:C,onVanishComplete:x,children:d})})})]}),p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:h,className:(0,r.cn)("text-sm text-blue-500  inline-flex items-center gap-1 transition-opacity duration-200 z-10  px-3 -mx-2 py-2 -my-2 rounded-5","hidden md:group-hover:flex"),children:["Learn how",(0,t.jsx)(u.Icon,{as:i.ArrowUpRight,className:"w-7 h-7 text-blue-500"})]}),(0,t.jsx)("button",{onClick:h,className:(0,r.cn)("text-blue-500 inline-flex items-center justify-center transition-opacity duration-200 z-10 p-2 -m-2 rounded-5","flex md:hidden"),children:(0,t.jsx)(u.Icon,{as:a.HelpCircle,className:"w-7 h-7 text-blue-500"})})]}),(0,t.jsx)("input",{type:"checkbox",checked:w,onChange:f?void 0:e=>y(e.target.checked),onClick:b?e=>{e.preventDefault(),S(!0),null==g||g()}:void 0,readOnly:f,className:(0,r.cn)("w-full h-full appearance-none absolute inset-0 rounded-lg",f?"cursor-default":"cursor-pointer")})]})})}},279791:e=>{"use strict";e.s({default:()=>c});var t=e.i(290479),r=e.i(330462),i=e.i(34818),a=e.i(373150),n=e.i(374943),s=e.i(252390),o=e.i(814733);let l=[{workflowKey:"import-and-chat-document",label:"Import and chat with a document"},{workflowKey:"add-files-to-folder",label:"Add files to a folder and chat with it"},{workflowKey:"create-new-note",label:"Create a new note"},{workflowKey:"mention-agent-in-chat",label:"@ mention an agent in chat"},{workflowKey:"connect-zotero",label:"Connect Zotero and import a file from your library"},{workflowKey:"annotate-document",label:"Annotate a document with a comment"},{workflowKey:"search-citation-in-note",label:"Add a citation to a Note"}];function c(){let[e,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),[m,p]=(0,a.useState)(new Set),[h,f]=(0,a.useState)(!1),{track:g}=(0,s.default)(),{data:x,isLoading:w}=o.api.featureTracking.getVerificationStatus.useQuery(void 0,{refetchOnMount:!0}),{data:y,isLoading:v}=o.api.featureTracking.getUserProgress.useQuery(void 0,{enabled:(null==x?void 0:x.allVerificationsComplete)||!(null==x?void 0:x.needsVerification),refetchOnMount:!0}),b=o.api.useUtils(),C=o.api.featureTracking.runRetroactiveVerification.useMutation({onSuccess:()=>{c(!1),d(!0),b.featureTracking.getUserProgress.invalidate(),b.featureTracking.getVerificationStatus.invalidate()},onError:()=>{c(!1),d(!0)}});o.api.featureTracking.resetUserProgressSoft.useMutation({onSuccess:()=>{b.featureTracking.getUserProgress.invalidate(),b.featureTracking.getVerificationStatus.invalidate()}});let S=o.api.featureTracking.dismissWorkflow.useMutation({onSuccess:()=>{b.featureTracking.getUserProgress.invalidate(),b.featureTracking.getVerificationStatus.invalidate()}}),T=o.api.featureTracking.markAllFeaturesCompleted.useMutation({onSuccess:()=>{b.featureTracking.getUserProgress.invalidate(),b.featureTracking.getVerificationStatus.invalidate()}});(0,a.useEffect)(()=>{b.featureTracking.getUserProgress.invalidate(),b.featureTracking.getVerificationStatus.invalidate()},[b]),(0,a.useEffect)(()=>{if((null==y?void 0:y.workflows)&&y.workflows.every(e=>e.isCompleted||e.isDismissed)&&!y.allFeaturesCompleted&&!h){let e=setTimeout(()=>{f(!0),T.mutate()},2250);return()=>clearTimeout(e)}},[y,h,T]),(0,a.useEffect)(()=>{null==x||!x.needsVerification||x.allVerificationsComplete||e||C.isPending||u||(c(!0),C.mutate())},[null==x?void 0:x.needsVerification,null==x?void 0:x.allVerificationsComplete,e,C.isPending,u]);let k=()=>{S.mutate({userId:"",workflowKey:"connect-zotero",isDismissed:!0})},L=()=>{p(e=>new Set(e).add("connect-zotero"))};return w||v||e||(null==y?void 0:y.allFeaturesCompleted)||C.isPending||(null==x?void 0:x.needsVerification)&&!x.allVerificationsComplete?null:(0,t.jsx)(r.AnimatePresence,{mode:"wait",children:!h&&(0,t.jsx)(i.motion.div,{className:"max-w-[44rem] w-full mx-auto",initial:{opacity:0,y:5,filter:"blur(4px)"},animate:{opacity:1,y:0,filter:"blur(0px)"},exit:{opacity:0,y:-20,filter:"blur(4px)",transition:{duration:.4,ease:"easeOut"}},transition:{duration:.4,ease:"easeOut"},children:(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)("h2",{className:"text-sm text-text-secondary mb-4",children:"Get started"}),(0,t.jsx)("div",{className:"",children:(0,t.jsx)(r.AnimatePresence,{mode:"popLayout",children:l.map(e=>{let r=null==y?void 0:y.workflows.find(t=>t.key===e.workflowKey),a=(null==r?void 0:r.isCompleted)||!1,s=(null==r?void 0:r.isDismissed)||!1,o=m.has(e.workflowKey);return s||o?null:(0,t.jsx)(i.motion.div,{initial:{opacity:1,y:0,filter:"blur(0px)"},exit:{opacity:0,y:-20,filter:"blur(4px)",transition:{duration:.3,ease:"easeOut"}},layout:!0,children:(0,t.jsx)(n.Checkbox,{label:e.label,initialChecked:a,showLearnHow:!a&&!!(null==r?void 0:r.learnMoreUrl),onLearnHowClick:()=>{(null==r?void 0:r.learnMoreUrl)&&(g("feature_learn_how_clicked",{feature_title:r.title,learn_more_url:r.learnMoreUrl,workflow_key:r.key}),window.open(r.learnMoreUrl,"_blank"))},readOnly:!0,steps:null==r?void 0:r.steps,hasMultipleSteps:(null==r?void 0:r.steps)&&r.steps.length>1,onZoteroDismissStart:"connect-zotero"===e.workflowKey?k:void 0,onZoteroDismissComplete:"connect-zotero"===e.workflowKey?L:void 0})},e.workflowKey)})})})]})})})}},997286:e=>{"use strict";e.s({useTeamInputText:()=>n});var t=e.i(564620),r=e.i(647968),i=e.i(608294);let a=(0,r.atom)(""),n=()=>{let[e,r]=(0,i.useAtom)(a,{store:t.globalStore});return{inputText:e,setInputText:r,insertText:e=>{r(e)}}}},792752:e=>{"use strict";e.s({default:()=>o});var t=e.i(290479),r=e.i(334145),i=e.i(194415),a=e.i(704255),n=e.i(663018),s=e.i(289702);let o=e=>{let{attachments:o,onRemove:l}=e;return 0===o.length?null:(0,t.jsx)("div",{className:"px-6 pt-6",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-4",children:o.map(e=>{if("image"!==e.data.type)return null;let o=e.data.isUploading;return(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("div",{className:"relative w-20 h-20 rounded-4 overflow-hidden bg-control-primary",children:[(0,t.jsx)(i.default,{src:e.data.url,alt:e.data.name,fill:!0,className:(0,s.cn)("object-cover transition-opacity",o&&"opacity-60"),sizes:"80px"}),o&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:(0,t.jsx)(n.LoadingSpinner,{variant:"small",color:"white"})})]}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",className:(0,s.cn)("absolute -top-4 -right-4 h-9 w-9 rounded-full","bg-control-destructive text-text-destructive","opacity-0 group-hover:opacity-100 transition-opacity","hover:bg-control-destructive/90"),onClick:()=>l(e.id),disabled:o,children:(0,t.jsx)(r.X,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{className:(0,s.cn)("mt-2 text-xs truncate max-w-[80px] text-text-secondary"),children:[e.data.name,o&&"..."]})]},e.id)})})})}},120081:e=>{"use strict";e.s({default:()=>o});var t=e.i(290479),r=e.i(330462),i=e.i(34818),a=e.i(373150),n=e.i(455578),s=e.i(289702);let o=e=>{let{suggestions:o,selectedIndex:l,onSuggestionClick:c,onSuggestionHover:u,isLoading:d,userInput:m}=e,[p,h]=(0,n.default)(),f=(0,a.useRef)(null),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{g.current&&f.current&&l>=0&&g.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[l]);let x=e=>{if(!(e.includes("[[tool:")||e.includes("[[mention:")))return e.trim();let t=e;return(t=(t=t.replace(/\[\[tool:[^:]+:([^\]]+)\]\]/g,"@$1")).replace(/\[\[mention:[^:]+:(.+?):[^\]]*\]\]/g,(e,t)=>{let r=t.lastIndexOf(":");if(-1!==r){let e=t.substring(0,r);return"@".concat(e)}return"@".concat(t)})).trim()},w=(0,a.useMemo)(()=>{let e=x(m);if(!e.trim())return o;if(e.toLowerCase().includes("complete form"))return[];if(e.toLowerCase().startsWith("summarize")||e.toLowerCase().startsWith("chat with file")||e.toLowerCase().startsWith("chat with folder"))return o;let t=e.toLowerCase();return o.filter(e=>e.toLowerCase().startsWith(t))},[o,m]);return d||0===w.length?null:(0,t.jsx)(i.motion.div,{initial:{height:h.height},animate:{height:h.height},exit:{height:0},transition:{duration:.2,ease:[.23,1,.32,1]},className:"overflow-hidden -mt-7 mb-2 autosug","data-autosuggestions":"true",children:(0,t.jsx)("div",{className:"border-t border-border-muted ",children:(0,t.jsx)("div",{ref:p,children:(0,t.jsx)(r.AnimatePresence,{mode:"wait",initial:!1,children:(w.length>0||d)&&(0,t.jsx)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"max-h-[250px] overflow-y-scroll scrollbar-hide p-2",ref:f,children:w.map((e,r)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{type:"button",ref:l===r?g:null,className:(0,s.cn)("w-full text-left px-4 py-4 rounded-4 text-sm hover:bg-popover-hover transition-colors flex items-center gap-4",l===r&&l>=0&&"bg-popover-hover"),onClick:()=>c(e),onMouseEnter:()=>u(r),children:(0,t.jsx)("span",{className:"flex-1",children:(e=>{let r=x(m);if(!r.trim())return e;if(r.toLowerCase().startsWith("summarize")||r.toLowerCase().startsWith("chat with file")||r.toLowerCase().startsWith("chat with folder"))return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"opacity-50 mr-2",children:r.trim()}),(0,t.jsx)("span",{className:"font-medium",children:e})]});let i=r.toLowerCase();if(e.toLowerCase().startsWith(i)){let i=e.substring(0,r.length),a=e.substring(r.length);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"opacity-50",children:i}),(0,t.jsx)("span",{className:"font-medium",children:a})]})}return e})(e)})}),r!==w.length-1&&(0,t.jsx)("hr",{className:"border-border-muted mx-4 my-1"})]},"suggestion-".concat(e.substring(0,20),"-").concat(r)))},"suggestions")})})})})}},579437:e=>{"use strict";e.s({CACHE_SIZE:()=>a,CACHE_TTL:()=>n,DEBOUNCE_MS:()=>r,MAX_SUGGESTION_LENGTH:()=>t,MIN_SUGGESTION_LENGTH:()=>i});let t=50,r=300,i=3,a=100,n=6e5},818437:e=>{"use strict";e.s({useAppLandingForm:()=>x});var t=e.i(174527),r=e.i(55579),i=e.i(450807),a=e.i(959757),n=e.i(885905),s=e.i(872967),o=e.i(950347),l=e.i(449097),c=e.i(997286),u=e.i(252390),d=e.i(60145),m=e.i(772476),p=e.i(257140),h=e.i(587870),f=e.i(373150),g=e.i(555168);let x=()=>{let e=(0,a.useForm)({schema:g.z.object({input:g.z.string().min(1)})}),{track:x}=(0,u.default)(),w=(0,d.usePendingMessageStore)(),y=(0,f.useRef)(null),v=(0,h.useTransitionRouter)(),{settings:b}=(0,l.useSettings)(),C=(0,m.useAnimationControls)(),{isDowntime:S}=(0,s.default)(),{inputText:T,setInputText:k}=(0,c.useTeamInputText)(),[L,j]=(0,f.useState)(!1),[N,E]=(0,f.useState)(""),[_,A]=(0,f.useState)(!1),[I,M]=(0,f.useState)(!1),[U,D]=(0,f.useState)(""),{createChat:P}=(0,r.useCreateChat)(),{showUpgrade:R}=(0,i.useUpgrade)(),{exceededLimits:O}=(0,o.default)(),{user:F}=(0,n.useAuth)(),{chatSources:G}=(0,t.useChatSources)(),W=(0,f.useCallback)(e=>{var t;let r=new URLSearchParams({model:b.modelName,maxLength:(null==(t=b.maxLength)?void 0:t.toString())||""});v.prefetch("/b/".concat(e,"?").concat(r.toString(),"&chatId=").concat(e))},[v,b.modelName,b.maxLength]),z=async t=>{var r;let{input:i,attachments:a=[]}=t;if((null==O?void 0:O.isWordCountLimitExceeded)&&!(null==F?void 0:F.teamsMemberOf.some(e=>"ACTIVE"===e.status))){R("messageLimit"),x("wordCountLimitHit",{userId:null==F?void 0:F.id,modelName:b.modelName}),x("Paywall Shown",{reason:"Word Count Limit Hit",type:"Message"});return}if(j(!0),S)return C.start({y:[5,0],x:[-5,0]}),e.reset();let n=i.toLowerCase().trim(),s=n.startsWith("chat with file")||n.startsWith("chat with folder"),o=a.filter(e=>"input-attachment"===e.type&&"mention"===e.data.type),l=s&&o.length>0,c=(0,p.nanoid)(),u=l?o[0].data.chatbotId:c;w.set(u,{text:i,attachments:a,chatSources:G});let d=l?o.map(e=>({type:"main",chatbotId:e.data.chatbotId})):[{type:"library"}],m=new URLSearchParams({model:b.modelName,maxLength:(null==(r=b.maxLength)?void 0:r.toString())||"",optimistic:"true",mode:l?"chatbot":"full-chat-library",pendingMessage:"true"});v.push("/b/".concat(u,"?").concat(m.toString(),"&chatId=").concat(c));try{await P({id:c,includedSources:d}),x("chat_nothing_created",{chatbotId:c,query:i,model:b.modelName,maxLength:b.maxLength,context:l?"chatbot":"library",hasAttachments:a.length>0})}catch(e){console.error("Chat creation failed:",e)}};return{form:e,formContainerRef:y,controls:C,isDowntime:S,isLoading:L,setIsLoading:j,currentInputValue:N,setCurrentInputValue:E,suggestionJustSelected:_,setSuggestionJustSelected:A,isFromPromptClick:I,setIsFromPromptClick:M,originalPromptText:U,setOriginalPromptText:D,handleSubmit:z,prefetchChatRoute:W,settings:b,inputText:T,setInputText:k}}},768181:e=>{"use strict";e.s({useEditorSetup:()=>x});var t=e.i(672614),r=e.i(309643);e.i(788606);var i=e.i(906250),a=e.i(606982);e.i(987617);var n=e.i(56077),s=e.i(737137),o=e.i(184782),l=e.i(257140),c=e.i(373150),u=e.i(719772),d=e.i(751746),m=e.i(483699),p=e.i(853985),h=e.i(653504),f=e.i(39888),g=e.i(579437);let x=e=>{let{onInputChange:x,form:w,setCurrentInputValue:y,suggestionJustSelected:v,setSuggestionJustSelected:b,isFromPromptClick:C,setIsFromPromptClick:S,originalPromptText:T,setOriginalPromptText:k,suggestions:L,previousSuggestions:j,setShowSuggestions:N,showSuggestions:E,selectedSuggestionIndex:_,setSelectedSuggestionIndex:A,handleSuggestionClick:I,setShouldHideSuggestions:M,shouldHideSuggestions:U,isSuggestionActive:D,handleSubmit:P,prefetchChatRoute:R,onPastedFiles:O}=e,{setEditor:F}=(0,u.useChatEditorTiptap)(),{createPasteHandler:G}=(0,p.usePasteFileHandlerGeneric)(O||(async()=>{})),W=(0,c.useRef)(null),z=(0,c.useRef)(!1),H=(0,c.useMemo)(()=>(0,d.createMentionExtension)(),[]),V=(0,c.useMemo)(()=>[t.default,a.default,s.default,H,i.default,h.CustomLink.configure({HTMLAttributes:{class:"px-1 rounded-[6px] bg-blue/10 !text-blue inline text-sm font-medium break-all max-w-full"},openOnClick:!1,autolink:!0}),r.default,n.default.configure({placeholder:(0,m.getPlaceholderText)({type:"full-chat-library"}),emptyEditorClass:"is-editor-empty"})],[H]);(0,c.useEffect)(()=>()=>{W.current&&clearTimeout(W.current)},[]);let K=(0,o.useEditor)({extensions:V,immediatelyRender:!1,shouldRerenderOnTransaction:!1,onCreate:e=>{let{editor:t}=e;F(t);let r={from:0,to:0};t.on("selectionUpdate",e=>{let{editor:t}=e,i={from:t.state.selection.from,to:t.state.selection.to};(i.from!==r.from||i.to!==r.to)&&(r=i)})},onUpdate:e=>{let{editor:t}=e,{text:r}=(0,f.extractEditorContent)(t),i=t.getText();w.setValue("input",r),y(i),x&&x(),i.trim().length>=3&&!z.current&&(W.current&&clearTimeout(W.current),W.current=setTimeout(()=>{R((0,l.nanoid)()),z.current=!0},500)),v&&b(!1),C&&r!==T&&(S(!1),k(""));let a=r.toLowerCase().startsWith("summarize ")||r.toLowerCase().startsWith("chat with "),n=/@([^@\s]+(?:\s+[^@\s]+)*)/g.test(r);if((r.length>=g.MIN_SUGGESTION_LENGTH&&r.length<=g.MAX_SUGGESTION_LENGTH||a&&!n)&&!v&&!document.querySelector(".tippy-box")){let e=L.length>0?L:j;if(e.length>0){let t=r.toLowerCase();a&&!n?N(!0):e.some(e=>e.toLowerCase().startsWith(t))&&N(!0)}}},editorProps:{handleKeyDown:(e,t)=>{let r=w.getValues("input")||"",i=e.state.doc.textContent,a=((e,t)=>{if(!(t.includes("[[tool:")||t.includes("[[mention:")))return e.trim();let r=t;return(r=(r=r.replace(/\[\[tool:[^:]+:([^\]]+)\]\]/g,"@$1")).replace(/\[\[mention:[^:]+:(.+?):[^\]]*\]\]/g,(e,t)=>{let r=t.lastIndexOf(":");if(-1!==r){let e=t.substring(0,r);return"@".concat(e)}return"@".concat(t)})).trim()})(i,r).toLowerCase(),n=L.length>0?L:j,s=i.toLowerCase().startsWith("summarize")||i.toLowerCase().startsWith("chat with"),o=/@([^@\s]+(?:\s+[^@\s]+)*)/g.test(r),l=s&&!o?n:n.filter(e=>e.toLowerCase().startsWith(a)),c=document.querySelector(".tippy-box");if(E&&l.length>0&&!c&&("ArrowDown"===t.key||"ArrowUp"===t.key))return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),"ArrowDown"===t.key?A(_<l.length-1?_+1:0):"ArrowUp"===t.key&&A(_>0?_-1:l.length-1),!0;if(E&&l.length>0&&!c&&"Enter"===t.key&&!t.shiftKey){if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),_>=0&&_<l.length)I(l[_]);else if(K){let{text:e,mentionAttachments:t}=(0,f.extractEditorContent)(K);e.trim()&&P({input:e,mentionAttachments:t})}return!0}if(E&&l.length>0&&!c&&"Escape"===t.key)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),N(!1),M(!0),!0;if("Enter"===t.key&&!t.shiftKey){if(D||!K)return!1;t.preventDefault();let{text:e,mentionAttachments:r}=(0,f.extractEditorContent)(K);return e.trim()&&P({input:e,mentionAttachments:r}),!0}return!1},handleClick:()=>{if(!E&&U&&!document.querySelector(".tippy-box")){let e=(w.getValues("input")||"").toLowerCase(),t=(L.length>0?L:j).some(t=>t.toLowerCase().startsWith(e));e.length>=g.MIN_SUGGESTION_LENGTH&&e.length<=g.MAX_SUGGESTION_LENGTH&&t&&(N(!0),M(!1))}},handlePaste:(e,t)=>(O&&G()(t),!1)}}),B=(0,c.useMemo)(()=>({type:"full-chat-library",chatId:""}),[]);return(0,m.useChatPlaceholder)(B,K),{editor:K,extensions:V}}},312762:e=>{"use strict";e.s({useFileHandling:()=>h});var t=e.i(238635),r=e.i(490076),i=e.i(608294),a=e.i(257140),n=e.i(373150),s=e.i(525094),o=e.i(719772),l=e.i(980919),c=e.i(231512),u=e.i(198057),d=e.i(252390),m=e.i(814733),p=e.i(985132);let h=()=>{let e=(0,n.useRef)(null),[h,f]=(0,n.useState)(!1),[g,x]=(0,n.useState)(!1),[w,y]=(0,n.useState)([]),[v,b]=(0,n.useState)(new Set),{mutateAsync:C}=m.api.aws.getSignedUploadUrl.useMutation(),{track:S}=(0,d.default)(),{ingestFile:T}=(0,c.default)(),{editor:k}=(0,o.useChatEditorTiptap)(),L=(0,i.useSetAtom)(p.addUploadingFilesAtom),j=(0,i.useSetAtom)(p.updateUploadingFileAtom),N=async e=>{f(!0);let r=L(e.map(e=>({name:e.name})));s.toast.custom(e=>n.default.createElement(l.FileUploadToastContent,{toastId:e}),{id:l.UPLOAD_TOAST_ID,duration:1/0,dismissible:!1,position:"bottom-left",className:"!px-0 !py-0 bg-popover border-border-primary !rounded-6"});for(let a=0;a<e.length;a++){let n=e[a],s=r[a];if(!s){console.error("Mismatch between input files and state files");continue}try{var i;let e=(null==(i=n.name.split(".").pop())?void 0:i.toLowerCase())||"";S("chatbotCreated",{chatbotId:"pending",fileExtension:e,type:"DOCUMENT"});let t=await T(n);if(t){let r=n.name.replace(RegExp("\\.".concat(e,"$"),"i"),"");j({id:s.id,status:"IN_PROGRESS",chatbotId:t}),k&&(k.commands.insertContent({type:"mention",attrs:{id:t,label:r,type:"DOCUMENT"}}),k.commands.insertContent(" ")),S("attachment_added",{type:n.type||"application/".concat(e)})}else j({id:s.id,status:"FAILED",errorMessage:"File could not be processed."})}catch(r){console.error("Failed to process document ".concat(n.name,":"),r);let e=r instanceof Error?r.message:"Upload failed";j({id:s.id,status:"FAILED",errorMessage:e}),S("fileUploadFailed",{reason:r instanceof Error?r.message:"Unknown error"}),t.captureException(r)}}f(!1)},E=async e=>{try{b(new Set(e.map(e=>e.name))),f(!0);let t=e.map(e=>{let t=e.name.split(".").slice(0,-1).join("."),r=e.name.split(".").pop();return{id:(0,a.nanoid)(),type:"input-attachment",data:{type:"image",name:t,extension:r||"",url:URL.createObjectURL(e),isUploading:!0}}});return y(e=>[...e,...t]),(await Promise.all(e.map(async(e,i)=>{try{let a=t[i],{signedUrl:n,url:s}=await C({fileName:e.name,fileType:e.type,type:"attachment",chatbotId:a.id}),o=await fetch(n,{method:"PUT",body:e,headers:{"Content-Type":e.type}});if(S("attachment_added",{type:e.type,from:"landing_page"}),!o.ok)throw Error("Upload failed: ".concat(o.statusText));return y(e=>e.map(e=>e.id===a.id?("image"===e.data.type&&e.data.url.startsWith("blob:")&&URL.revokeObjectURL(e.data.url),{...e,data:{...e.data,url:(0,r.getAttachmentCdnUrl)(s,a.id),isUploading:!1}}):e)),{url:s,name:e.name,type:e.type,id:a.id}}catch(a){console.error("Failed to upload ".concat(e.name,":"),a);let r=t[i];return y(e=>e.filter(e=>e.id!==r.id||("image"===e.data.type&&e.data.url.startsWith("blob:")&&URL.revokeObjectURL(e.data.url),!1))),null}}))).filter(e=>null!==e)}catch(e){console.error(e),s.toast.error("Failed to upload files")}finally{b(new Set),f(!1)}},{handleFileChange:_}=(0,u.useFileChange)(),A=async e=>{let t=e.target.files;if(!t)return;let r=Array.from(t);try{await _(r,{currentAttachmentCount:w.length,onImageFiles:E,onDocumentFiles:N})}catch(e){console.error("File upload error:",e)}finally{e.target.value=""}};return(0,n.useEffect)(()=>{let e=()=>{x(!1)};if(g)return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[g]),(0,n.useEffect)(()=>()=>{w.forEach(e=>{"image"===e.data.type&&e.data.url.startsWith("blob:")&&URL.revokeObjectURL(e.data.url)})},[w]),{fileInputRef:e,isUploading:h,isFileInputOpen:g,setIsFileInputOpen:x,openFileInput:()=>{var t;null==(t=e.current)||t.click()},handleFileChangeFn:A,attachments:w,removeAttachment:e=>{y(t=>t.filter(t=>t.id!==e||("image"===t.data.type&&t.data.url.startsWith("blob:")&&URL.revokeObjectURL(t.data.url),!1)))},uploadFile:E,handleDocumentIngestion:N}}},700259:e=>{"use strict";e.s({useSuggestions:()=>n});var t=e.i(11968),r=e.i(814733),i=e.i(373150);class a{get(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.ttl?(this.cache.delete(e),null):(this.cache.delete(e),this.cache.set(e,t),t.suggestions):null}set(e,t,r){if(this.cache.size>=this.maxSize&&!this.cache.has(e)){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(e,{suggestions:t,timestamp:Date.now(),context:r})}getPrefixMatch(e,t){for(let r of Array.from(this.cache.keys()).filter(r=>{var i;return r.startsWith(e)&&(null==(i=this.cache.get(r))?void 0:i.context)===t}).sort((e,t)=>t.length-e.length)){let t=this.cache.get(r);if(t&&Date.now()-t.timestamp<=this.ttl)return t.suggestions.filter(t=>t.toLowerCase().startsWith(e.toLowerCase())).slice(0,5)}return null}clear(){this.cache.clear()}constructor(e,r){(0,t._)(this,"cache",void 0),(0,t._)(this,"maxSize",void 0),(0,t._)(this,"ttl",void 0),this.cache=new Map,this.maxSize=e,this.ttl=r}}function n(e){let{text:t,context:n,enabled:s=!0,debounceMs:o=500,cacheSize:l=50,cacheTTL:c=3e5}=e,[u,d]=(0,i.useState)([]),[m,p]=(0,i.useState)(!1),[h,f]=(0,i.useState)(null),[g,x]=(0,i.useState)(!1),w=(0,i.useRef)(null),y=(0,i.useRef)(""),v=(0,i.useRef)(""),b=(0,i.useRef)([]),C=(0,i.useRef)(null),S=(0,i.useRef)(new Set),T=(0,i.useMemo)(()=>new a(l,c),[l,c]),k=(0,i.useCallback)((e,t)=>{if(!e.trim()||0===t.length)return[];let r=e.toLowerCase();return t.filter(e=>e.toLowerCase().startsWith(r))},[]),L=r.api.suggestions.generate.useMutation({onSuccess:(e,t)=>{let r="".concat(t.text,"-").concat(t.context);if(r===y.current){let i=e.suggestions.filter(e=>null!==e);d(i),p(!1),f(null),x(!1),b.current=i,T.set(t.text.toLowerCase(),i,t.context||"generalKnowledge"),S.current.delete(r)}},onError:(e,t)=>{let r="".concat(t.text,"-").concat(t.context);r===y.current&&(console.error("[useSuggestions] Error:",e),f(e.message||"Failed to fetch suggestions"),d([]),p(!1),x(!1),S.current.delete(r))}}),j=(0,i.useCallback)((e,t)=>{L.mutate({text:e,context:t})},[]),N=(0,i.useCallback)((e,t)=>{let r=e.toLowerCase(),i="".concat(e,"-").concat(t);if(S.current.has(i))return;let a=T.get(r);if(a&&a.length>0){d(a),p(!1),f(null),x(!0),b.current=a;return}if(v.current.startsWith(e)&&e.length<v.current.length){let e=T.getPrefixMatch(r,t);if(e&&e.length>0){d(e),p(!1),f(null),x(!0),b.current=e;return}}y.current=i,S.current.add(i),p(!0),f(null),x(!1),j(e,t)},[T,j]);return(0,i.useEffect)(()=>{if(!s){d([]),p(!1);return}if(!t.trim()||t.length<3){d([]),p(!1),x(!1),b.current=[],v.current=t;return}C.current&&C.current.abort(),C.current=new AbortController,w.current&&clearTimeout(w.current);let e=t.toLowerCase(),r=T.get(e);if(r&&r.length>0){d(r),p(!1),f(null),x(!0),b.current=r,v.current=t;return}if(b.current.length>0){let e=k(t,b.current);if(e.length>0){d(e),x(!1),f(null),e.length<5?(p(!0),w.current=setTimeout(()=>{N(t,n)},o)):(p(!1),b.current=e),v.current=t;return}}return p(!0),w.current=setTimeout(()=>{N(t,n)},o),v.current=t,()=>{w.current&&clearTimeout(w.current),C.current&&C.current.abort()}},[t,n,s,o,T,N,k]),(0,i.useEffect)(()=>()=>{w.current&&clearTimeout(w.current),C.current&&C.current.abort(),S.current.clear()},[]),{suggestions:u,isLoading:m,error:h,isFromCache:g,clearCache:(0,i.useCallback)(()=>{T.clear()},[T]),preloadSuggestions:(0,i.useCallback)(e=>{if(e.length>=3&&!T.get(e.toLowerCase())){let t="".concat(e,"-").concat(n);S.current.has(t)||(y.current=t,S.current.add(t),j(e,n))}},[T,n,j])}}},122467:e=>{"use strict";e.s({useSuggestionLogic:()=>o});var t=e.i(373150),r=e.i(702461),i=e.i(700259),a=e.i(852951),n=e.i(252390),s=e.i(579437);let o=e=>{let{currentInputValue:o,suggestionJustSelected:l,isFromPromptClick:c,originalPromptText:u,formContainerRef:d}=e,[m,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)(-1),[g,x]=(0,t.useState)(!1),[w,y]=(0,t.useState)([]),[v,b]=(0,t.useState)(!1),{data:C}=(0,a.useWorkspace)(),S=o.toLowerCase().startsWith("summarize"),T=o.toLowerCase().startsWith("chat with file"),k=o.toLowerCase().startsWith("chat with folder"),L=o.toLowerCase().startsWith("how does anara"),j=["How does Anara complete research tasks automatically?","How does Anara differ from ChatGPT for research?","How does Anara support different file types?","How does Anara affect my ability to conduct independent research?","How does Anara organize and search through my documents?"].some(e=>o.toLowerCase()===e.toLowerCase()),N=L&&!j,E=S||T||k||N,{track:_}=(0,n.default)(),A=(e=>{if(!(e.includes("[[tool:")||e.includes("[[mention:")))return e.trim();let t=e;return(t=(t=t.replace(/\[\[tool:[^:]+:([^\]]+)\]\]/g,"@$1")).replace(/\[\[mention:[^:]+:(.+?):[^\]]*\]\]/g,(e,t)=>{let r=t.lastIndexOf(":");if(-1!==r){let e=t.substring(0,r);return"@".concat(e)}return"@".concat(t)})).trim()})(o),{suggestions:I,isLoading:M,error:U,clearCache:D,preloadSuggestions:P}=(0,i.useSuggestions)({text:A,context:N?"learn-anara":"library",enabled:A.length>=s.MIN_SUGGESTION_LENGTH&&A.length<=s.MAX_SUGGESTION_LENGTH||E,debounceMs:s.DEBOUNCE_MS,cacheSize:s.CACHE_SIZE,cacheTTL:s.CACHE_TTL});return(0,t.useEffect)(()=>{I.length>0&&y(I);let e=A.toLowerCase(),t=(I.length>0?I:w).some(t=>t.toLowerCase().startsWith(e)),r=document.querySelector(".tippy-box"),i=/@([^@\s]+(?:\s+[^@\s]+)*)/g.test(o),a=(S||T||k)&&!i,n="summ"!==o.toLowerCase()&&"summa"!==o.toLowerCase()&&"summar"!==o.toLowerCase()&&"summari"!==o.toLowerCase()&&"summariz"!==o.toLowerCase()&&"chat with"!==o.toLowerCase()&&"chat wi"!==o.toLowerCase()&&"chat wit"!==o.toLowerCase()&&"chat with f"!==o.toLowerCase()&&"chat with fi"!==o.toLowerCase()&&"chat with fil"!==o.toLowerCase()&&"chat with file"!==o.toLowerCase()&&"chat with fo"!==o.toLowerCase()&&"chat with fol"!==o.toLowerCase()&&"chat with fold"!==o.toLowerCase()&&"chat with folde"!==o.toLowerCase()&&"chat with folder"!==o.toLowerCase()&&!j&&(o.length>=s.MIN_SUGGESTION_LENGTH&&o.length<=s.MAX_SUGGESTION_LENGTH||a||N)&&(!l||c)&&!v&&!r&&(t||M&&!U||c||a||N);if(!n&&g&&!t&&!c){let e=setTimeout(()=>{x(!1),b(!1)},100);return()=>clearTimeout(e)}if(x(n),I.length>0&&I!==w&&f(-1),c){let e=setTimeout(()=>{},1e3);return()=>clearTimeout(e)}},[I,M,o,l,w,U,v,g,c,u,E]),(0,t.useEffect)(()=>{D()},[D]),(0,t.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&g&&(x(!1),b(!0))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[g,d]),(0,t.useEffect)(()=>{let e=new MutationObserver(e=>{for(let t of e)"childList"===t.type&&p(!!document.querySelector(".tippy-box"))});return e.observe(document.body,{childList:!0,subtree:!0}),()=>e.disconnect()},[]),{suggestions:I,isSuggestionsLoading:M,error:U,clearCache:D,preloadSuggestions:P,isSuggestionActive:m,setIsSuggestionActive:p,selectedSuggestionIndex:h,setSelectedSuggestionIndex:f,showSuggestions:g,setShowSuggestions:x,previousSuggestions:w,setPreviousSuggestions:y,shouldHideSuggestions:v,setShouldHideSuggestions:b,handleSuggestionClick:(e,t,i)=>{if(t){let m=e=>{for(let t of["Search Web","Search Papers","Search Workspace","Search YouTube","Edit Note","Complete Form","Create Citation","Create Flashcards","Research"])if(RegExp("@".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),"i").test(e))return!0;return!!/@[a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9]+)?\b/.test(e)},p=t.getText()||o,h=/@([^@\s]+(?:\s+[^@\s]+)*)/g.test(p);if((S||T||k)&&!h&&!m(e)){var a,n,s,l,c,u,d;let r=null==C||null==(a=C.entities)?void 0:a[0];r=void 0,r=k?(null==C||null==(n=C.entities)?void 0:n.find(t=>"GROUP"===t.type&&t.name===e))||(null==C||null==(s=C.entities)?void 0:s.find(t=>{var r;return"GROUP"===t.type&&(null==(r=t.name)?void 0:r.includes(e))})):T?(null==C||null==(l=C.entities)?void 0:l.find(t=>"GROUP"!==t.type&&t.name===e))||(null==C||null==(c=C.entities)?void 0:c.find(t=>{var r;return"GROUP"!==t.type&&(null==(r=t.name)?void 0:r.includes(e))})):(null==C||null==(u=C.entities)?void 0:u.find(t=>t.name===e))||(null==C||null==(d=C.entities)?void 0:d.find(t=>{var r;return null==(r=t.name)?void 0:r.includes(e)})),t.commands.clearContent();t.commands.insertContent(S?"Summarize ":T?"Chat with file ":"Chat with folder "),r?t.commands.insertContent({type:"mention",attrs:{id:r.id,label:r.name||e,type:r.type}}):t.commands.insertContent({type:"mention",attrs:{id:e,label:e,type:"DOCUMENT"}}),t.commands.insertContent(" ");let o=t.getHTML();i.setValue("input",o)}else N&&!m(e)?(t.commands.setContent(e),i.setValue("input",e)):m(e)?(e=>{t.commands.clearContent();let a=r.TOOL_MAP,n=(e=>{let t,r=[];for(let t of Object.keys(a)){let i,a=RegExp("@(".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")\\b"),"gi");for(i=a.exec(e);i;)r.push({start:i.index,end:i.index+i[0].length,text:i[1],type:"tool"}),i=a.exec(e)}if(null==C?void 0:C.entities)for(let t of C.entities){let i=t.name||"";if(i){let t,a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=RegExp("@(".concat(a,")\\b"),"gi");for(t=n.exec(e);t;)r.some(e=>t.index>=e.start&&t.index<e.end)||r.push({start:t.index,end:t.index+t[0].length,text:t[1],type:"file"}),t=n.exec(e)}}let i=/@([a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9]+)?)\b/g;for(t=i.exec(e);t;)r.some(e=>t.index>=e.start&&t.index<e.end)||r.push({start:t.index,end:t.index+t[0].length,text:t[1],type:"file"}),t=i.exec(e);return r.sort((e,t)=>e.start-t.start)})(e),s=0;for(let r of n){if(r.start>s){let i=e.substring(s,r.start);i&&t.commands.insertContent(i)}let i=a[r.text];if(i)t.commands.insertContent({type:"mention",attrs:{id:i.id,label:i.label,type:"TOOL",toolType:i.toolType}});else{var o;let e=null==C||null==(o=C.entities)?void 0:o.find(e=>{var t;return e.name===r.text||(null==(t=e.name)?void 0:t.includes(r.text))});e?t.commands.insertContent({type:"mention",attrs:{id:e.id,label:e.name||r.text,type:e.type}}):t.commands.insertContent({type:"mention",attrs:{id:r.text,label:r.text,type:"DOCUMENT"}})}s=r.end}if(s<e.length){let r=e.substring(s);r&&t.commands.insertContent(r)}let l=t.getHTML();i.setValue("input",l)})(e):(t.commands.setContent(e),i.setValue("input",e));_("autocomplete_suggestion_clicked",{suggestion:e,input:o}),x(!1),f(-1),t.commands.focus("end")}},handleSuggestionHover:e=>{f(e)},shouldDisableInput:()=>{let e=/@([^@\s]+(?:\s+[^@\s]+)*)/g.test(o);return(S||T||k)&&!e},isSpecialPrompt:E}}},831922:e=>{"use strict";e.s({default:()=>_});var t=e.i(290479),r=e.i(184782),i=e.i(592103),a=e.i(911233),n=e.i(330462),s=e.i(34818),o=e.i(373150),l=e.i(525094),c=e.i(410622),u=e.i(950721),d=e.i(656154),m=e.i(353964),p=e.i(855399),h=e.i(475292),f=e.i(958962),g=e.i(959757),x=e.i(476440),w=e.i(732946),y=e.i(39888),v=e.i(83755),b=e.i(289702),C=e.i(792752),S=e.i(120081),T=e.i(579437),k=e.i(818437),L=e.i(768181),j=e.i(312762),N=e.i(122467);let E=(0,o.forwardRef)((e,E)=>{let{onInputChange:_,disabledInput:A,showAttachmentTooltip:I}=e,[M,U]=(0,o.useState)(!1),{form:D,formContainerRef:P,controls:R,isDowntime:O,isLoading:F,setIsLoading:G,currentInputValue:W,setCurrentInputValue:z,suggestionJustSelected:H,setSuggestionJustSelected:V,isFromPromptClick:K,setIsFromPromptClick:B,originalPromptText:q,setOriginalPromptText:Z,handleSubmit:$,prefetchChatRoute:X,inputText:Q,setInputText:Y}=(0,k.useAppLandingForm)(),{fileInputRef:J,isUploading:ee,setIsFileInputOpen:et,openFileInput:er,handleFileChangeFn:ei,attachments:ea,removeAttachment:en,uploadFile:es,handleDocumentIngestion:eo}=(0,j.useFileHandling)(),{suggestions:el,isSuggestionsLoading:ec,showSuggestions:eu,setShowSuggestions:ed,previousSuggestions:em,shouldHideSuggestions:ep,setShouldHideSuggestions:eh,selectedSuggestionIndex:ef,setSelectedSuggestionIndex:eg,isSuggestionActive:ex,handleSuggestionClick:ew,handleSuggestionHover:ey,shouldDisableInput:ev}=(0,N.useSuggestionLogic)({currentInputValue:W,suggestionJustSelected:H,isFromPromptClick:K,originalPromptText:q,formContainerRef:P}),eb=e=>{let{mentionAttachments:t=[],...r}=e,i=[...ea,...t];$({...r,attachments:i})},eC=e=>{eS&&(ew(e,eS,D),z(e),V(!0))},{editor:eS}=(0,L.useEditorSetup)({onInputChange:_,form:D,setCurrentInputValue:z,suggestionJustSelected:H,setSuggestionJustSelected:V,isFromPromptClick:K,setIsFromPromptClick:B,originalPromptText:q,setOriginalPromptText:Z,suggestions:el,previousSuggestions:em,setShowSuggestions:ed,showSuggestions:eu,selectedSuggestionIndex:ef,setSelectedSuggestionIndex:eg,handleSuggestionClick:eC,setShouldHideSuggestions:eh,shouldHideSuggestions:ep,isSuggestionActive:ex,handleSubmit:eb,prefetchChatRoute:X,onPastedFiles:async e=>{let t=e.filter(e=>e.type.startsWith("image/")),r=e.filter(v.isSupportedDocumentType);t.length>0&&await es(t),r.length>0&&await eo(r)}});(0,o.useEffect)(()=>{eS&&eS.commands.focus()},[eS]),(0,o.useImperativeHandle)(E,()=>({focusEditor:()=>{null==eS||eS.commands.focus()},insertText:e=>{eS&&eS.commands.insertContent(e)},isEditorFocused:()=>{var e;return null!=(e=null==eS?void 0:eS.isFocused)&&e},getEditor:()=>eS,handleDroppedFiles:async e=>{let t=e.filter(e=>e.type.startsWith("image/")),r=e.filter(v.isSupportedDocumentType),i=e.filter(e=>!e.type.startsWith("image/")&&!(0,v.isSupportedDocumentType)(e));if(i.length>0){let e=i.map(e=>e.name).join(", ");l.toast.error("Unsupported file type".concat(i.length>1?"s":"",": ").concat(e))}t.length>0&&await es(t),r.length>0&&await eo(r)},setIsDragging:e=>{U(e)}}),[eS,es,eo,U]),(0,o.useEffect)(()=>{Q&&eS&&(eS.commands.setContent(Q),z(Q),B(!0),Z(Q),Q.length>=T.MIN_SUGGESTION_LENGTH&&Q.length<=T.MAX_SUGGESTION_LENGTH&&(ed(!0),eh(!1),V(!1)),eS.commands.focus("end"),Y(""))},[Q,eS,z,B,Z,ed,eh,V,Y]);let eT=(null==eS?void 0:eS.getText())||"",ek=D.formState.isSubmitting||A||ev(),eL=(0,o.useCallback)(async e=>{e.preventDefault(),U(!1);let t=Array.from(e.dataTransfer.files);if(t.length>0){let e=t.filter(e=>e.type.startsWith("image/")),r=t.filter(v.isSupportedDocumentType),i=t.filter(e=>!e.type.startsWith("image/")&&!(0,v.isSupportedDocumentType)(e));if(i.length>0){let e=i.map(e=>e.name).join(", ");l.toast.error("Unsupported file type".concat(i.length>1?"s":"",": ").concat(e))}e.length>0&&await es(e),r.length>0&&await eo(r)}},[es,eo]),ej=(0,o.useCallback)(()=>{if(!eS)return!1;let{text:e}=(0,y.extractEditorContent)(eS);return/\[\[mention:[^\]]+\]\]/.test(e)},[eS,eT]),eN=(0,o.useMemo)(()=>{let e=eT.toLowerCase().trim();return e.startsWith("summarize")||e.startsWith("chat with file")||e.startsWith("chat with folder")},[eT]),eE=(0,o.useMemo)(()=>eN&&0===ea.length&&!ej(),[eN,ea.length,ej]),e_=(0,o.useMemo)(()=>I||eE,[I,eE]),eA=(0,o.useMemo)(()=>O||ek||!eT.length||e_,[O,ek,eT.length,e_]),eI=(0,o.useCallback)(()=>{if(F)return void G(!1);if(eS){let{text:e,mentionAttachments:t}=(0,y.extractEditorContent)(eS);e.trim()&&eb({input:e,mentionAttachments:t})}},[F,eS,eb,G,ea]);return(0,t.jsxs)("div",{className:"absolute left-0 mb-6 flex flex-col text-sm z-10 bg-none bg-transparent max-w-3xl mx-auto w-full",children:[O&&(0,t.jsx)(c.default,{}),(0,t.jsxs)(s.motion.div,{ref:P,animate:R,id:"answer-questions",className:"flex z-0 flex-col justify-between gap-2 rounded-8 shadow-feint p-[1px] bg-popover-hover-solid overflow-hidden",style:{viewTransitionName:"chat-input-container"},onDrop:eL,onDragOver:e=>e.preventDefault(),onDragEnter:e=>{e.preventDefault(),(e=>{if(!e.types.includes("Files"))return!1;if(e.items&&e.items.length>0){for(let r=0;r<e.items.length;r++){let i=e.items[r];if("file"===i.kind){var t;if((null==(t=i.type)?void 0:t.startsWith("image/"))||i.type&&w.ALLOWED_FILE_TYPES.includes(i.type)||!i.type||""===i.type)return!0}}return!1}return!0})(e.dataTransfer)&&U(!0)},onDragLeave:e=>{var t;e.preventDefault();let r=e.relatedTarget;r&&(null==(t=P.current)?void 0:t.contains(r))||U(!1)},children:[(0,t.jsx)(n.AnimatePresence,{children:M&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"absolute inset-0 z-50 pointer-events-none flex items-center justify-center rounded-8",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-blue/10 backdrop-blur-sm rounded-8 border-2 border-dashed border-blue"}),(0,t.jsxs)("div",{className:"relative flex flex-col items-center gap-2",children:[(0,t.jsx)(a.UploadIcon,{className:"w-8 h-8 text-blue"}),(0,t.jsx)("p",{className:"text-sm font-medium text-blue",children:"Drop files to add to chat"})]})]})}),ea.length>0&&(0,t.jsx)(C.default,{attachments:ea,onRemove:en}),(0,t.jsxs)("div",{onClick:e=>{let t=e.target;e.currentTarget.contains(t)&&e.isTrusted&&(t.closest("button, a, input, select, textarea")||null==eS||eS.commands.focus())},className:"relative flex flex-col justify-between  rounded-8 bg-popover max-h-[24rem] min-h-[76px]  z-10 gap-7",children:[(0,t.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto px-3.5 pt-6",children:(0,t.jsx)(g.Form,{...D,children:(0,t.jsx)("form",{id:"prompt",onSubmit:D.handleSubmit(eb),children:(0,t.jsx)("div",{className:"w-full leading-[22px] text-sm max-sm:text-sm truncate resize-none bg-transparent disabled:text-text-secondary focus:outline-none placeholder:text-text-secondary scrollbar-hide border-none",children:(0,t.jsx)(r.EditorContent,{editor:eS,disabled:ek,className:"[&_.ProseMirror]:outline-none [&_.ProseMirror]:min-h-[22px] [&_.ProseMirror.is-editor-empty]:before:content-[attr(data-placeholder)] [&_.ProseMirror.is-editor-empty]:before:text-text-secondary [&_.ProseMirror.is-editor-empty]:before:float-left [&_.ProseMirror.is-editor-empty]:before:pointer-events-none [&_.ProseMirror.is-editor-empty]:before:h-0 ".concat(ev()?"[&_.ProseMirror]:opacity-50 [&_.ProseMirror]:cursor-not-allowed":"")})})})})}),(0,t.jsxs)("div",{className:"flex-shrink-0 px-6 pb-6",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between w-full gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center min-w-0 flex-1",children:[(0,t.jsx)(d.MentionDropdown,{landingPage:!0}),(0,t.jsx)(m.ModelSelectionDropdown,{}),(0,t.jsx)(h.TextLengthDropdown,{}),(0,t.jsx)(p.SettingsDropdown,{canControlChatSources:!0})]}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 flex-shrink-0",children:[e_?(0,t.jsx)(x.ReusableTooltip,{content:"Attach file",open:!0,asChild:!0,children:(0,t.jsx)(u.AttachmentPopover,{isUploading:ee,onFileInputClick:er,location:"landing"})}):(0,t.jsx)(x.PersistentTooltip,{content:"Add attachments",persistent:!1,asChild:!0,children:(0,t.jsx)(u.AttachmentPopover,{isUploading:ee,onFileInputClick:er,location:"landing"})}),(0,t.jsx)("button",{disabled:!F&&(eA||!eT.length),onClick:eI,className:(0,b.cn)("disabled:opacity-50 disabled:cursor-not-allowed","flex justify-center items-center rounded-full p-3 ease-in transition-all duration-150 cursor-pointer bg-blue text-white",(eT.length||F)&&!eA?"":"bg-secondary dark:bg-secondary text-text-secondary"),children:F?(0,t.jsx)(f.StopIcon,{className:"h-7 w-7 p-1"}):(0,t.jsx)(i.ArrowUp,{className:"h-7 w-7"})})]})]}),(0,t.jsx)("input",{type:"file",ref:J,onChange:e=>{ei(e),et(!1)},onClick:()=>et(!0),className:"hidden",multiple:!0,accept:".png,.jpg,.jpeg,.webp,.gif,.pdf,.epub,.ppt,.pptx,.doc,.docx,.tiff,.bmp,.heic,.txt,.md"})]}),(0,t.jsx)(n.AnimatePresence,{children:eu&&(0,t.jsx)(S.default,{suggestions:el.length>0?el:em,selectedIndex:ef,onSuggestionClick:eC,onSuggestionHover:ey,isLoading:ec,userInput:W})})]})]})]})});E.displayName="AppLandingForm";let _=E},492948:e=>{"use strict";e.s({default:()=>t});let t=(0,e.i(238959).default)("squircle-dashed",[["path",{d:"M13.77 3.043a34 34 0 0 0-3.54 0",key:"1oaobr"}],["path",{d:"M13.771 20.956a33 33 0 0 1-3.541.001",key:"95iq0j"}],["path",{d:"M20.18 17.74c-.51 1.15-1.29 1.93-2.439 2.44",key:"1u6qty"}],["path",{d:"M20.18 6.259c-.51-1.148-1.291-1.929-2.44-2.438",key:"1ew6g6"}],["path",{d:"M20.957 10.23a33 33 0 0 1 0 3.54",key:"1l9npr"}],["path",{d:"M3.043 10.23a34 34 0 0 0 .001 3.541",key:"1it6jm"}],["path",{d:"M6.26 20.179c-1.15-.508-1.93-1.29-2.44-2.438",key:"14uchd"}],["path",{d:"M6.26 3.82c-1.149.51-1.93 1.291-2.44 2.44",key:"8k4agb"}]])},525015:e=>{"use strict";e.s({SquircleDashed:()=>t.default});var t=e.i(492948)},463081:e=>{"use strict";e.s({default:()=>p});var t=e.i(736016),r=e.i(360911),i=e.i(490282),a=e.i(59938),n=e.i(502753),s=e.i(471851),o=e.i(516555),l=e.i(441729),c=e.i(519927),u=e.i(525015),d=e.i(359858),m=e.i(958962);let p=[{id:"create-citation",icon:o.MessageSquareQuote,title:"Create citation",prompt:"",toolType:"createCitation"},{id:"search-papers",icon:t.BookOpenText,title:"Search for papers",prompt:"on ",toolType:"academicSearch"},{id:"search-web",icon:n.Globe,title:"Search the web",prompt:"for ",toolType:"webSearch"},{id:"search-youtube",icon:d.Youtube,title:"Search YouTube",prompt:"on ",toolType:"youtubeSearch"},{id:"search-library",icon:a.FolderSearch,title:"Search workspace",prompt:"for",toolType:"librarySearch"},{id:"create-flashcards",icon:s.Layers2,title:"Create flashcards",prompt:"for ",toolType:"flashcardGenerator"},{id:"outline-literature-review",icon:u.SquircleDashed,title:"Outline literature review",prompt:"Outline literature review on "},{id:"learn-anara",icon:m.AnaraIcon,title:"Learn Anara",prompt:"__LEARN_ANARA__"},{id:"create-note",icon:c.PencilLine,title:"Create note",prompt:"__CREATE_NOTE__"},{id:"chat-with-file",icon:r.FileText,title:"Chat with file",prompt:"Chat with file "},{id:"summarize-paper",icon:l.Minimize2,title:"Summarize paper",prompt:"Summarize "},{id:"chat-with-folder",icon:i.FolderOpen,title:"Chat with folder",prompt:"Chat with folder "}]},864945:e=>{"use strict";e.s({default:()=>d});var t=e.i(290479),r=e.i(381612),i=e.i(373150),a=e.i(704255),n=e.i(448068),s=e.i(476440),o=e.i(702461),l=e.i(289702),c=e.i(463081);let u=["summarize-paper","chat-with-folder","chat-with-file"],d=e=>{let{onPromptClick:d,getEditor:m,onCreateNote:p}=e,h=(0,i.useRef)(null),[f,g]=(0,i.useState)(!1),[x,w]=(0,i.useState)(!1),[y,v]=(0,i.useState)(!1),b=["chat-with-file","chat-with-folder","outline-literature-review","create-note"],C=["search-papers","summarize-paper","learn-anara"],S=b.map(e=>c.default.find(t=>t.id===e)).filter(Boolean),T=C.map(e=>c.default.find(t=>t.id===e)).filter(Boolean),k=[...b,...C],L=c.default.filter(e=>!k.includes(e.id)),j=[...S,...T,...L],N=()=>{if(h.current){let{scrollLeft:e,scrollWidth:t,clientWidth:r}=h.current;g(e>0),w(e<t-r-1)}};(0,i.useEffect)(()=>{N()},[]);let E=o.TOOL_MAP_BY_KEY,_=e=>{if("__LEARN_ANARA__"===e.prompt)return void d("How does Anara");if("__CREATE_NOTE__"===e.prompt){null==p||p();return}let t=m();if(t&&e.toolType){let r=E[e.toolType];if(r){t.commands.clearContent(),t.commands.insertContent({type:"mention",attrs:{id:r.id,label:r.label,type:"TOOL",toolType:r.toolType}}),t.commands.insertContent(" "),t.commands.insertContent(e.prompt),t.commands.focus("end");return}}d(e.prompt)},A=(e,r)=>{let i=e.icon,n=u.includes(e.id),o=(0,t.jsx)(a.Button,{shape:"pill",variant:"outline",onClick:()=>_(e),className:"flex items-center gap-4 px-6  whitespace-nowrap flex-shrink-0 h-[34px] text-sm",leadingIcon:(0,t.jsx)(i,{className:"w-[14px] h-[14px]"}),children:(0,t.jsx)("span",{className:"text-sm font-medium",children:e.title})},r);return n?(0,t.jsx)(s.ReusableTooltip,{content:"Requires documents or folders in your library",position:"top",asChild:!0,children:o},r):o};return(0,t.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-4 max-w-[44rem] w-full duration-0"),children:[(0,t.jsxs)("div",{className:"hidden md:flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-3 justify-center",children:S.map(e=>A(e,"first-".concat(e.id)))}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 justify-center",children:[T.map(e=>A(e,"second-".concat(e.id))),(0,t.jsxs)(n.DropdownMenu,{open:y,onOpenChange:v,children:[(0,t.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(a.Button,{shape:"pill",variant:"outline",className:"flex items-center gap-2 select-none px-6 w-fit border border-border-primary hover:bg-secondary rounded-full transition-colors whitespace-nowrap flex-shrink-0 h-[34px] text-sm",trailingIcon:(0,t.jsx)(r.ChevronDown,{className:"w-[14px] h-[14px]"}),children:(0,t.jsx)("span",{className:"text-sm font-medium",children:"More"})})}),(0,t.jsx)(n.DropdownMenuContent,{align:"start",className:"min-w-[218px] p-2",onCloseAutoFocus:e=>{e.preventDefault()},children:L.map(e=>{let r=e.icon,i=u.includes(e.id),o=(0,t.jsx)(n.DropdownMenuItem,{asChild:!0,onSelect:t=>{t.preventDefault(),_(e),v(!1)},children:(0,t.jsx)(a.Button,{variant:"ghost",size:"medium",className:"w-full justify-start",onClick:t=>{t.preventDefault(),t.stopPropagation(),_(e),v(!1)},leadingIcon:(0,t.jsx)(r,{className:"w-7 h-7"}),label:e.title})},e.id);return i?(0,t.jsx)(s.ReusableTooltip,{content:"Requires documents or folders in your library",position:"top",asChild:!0,children:o},e.id):o})})]})]})]}),(0,t.jsxs)("div",{className:"md:hidden -mx-10 sm:mx-0 w-screen sm:w-0  relative rounded-4 overflow-hidden min-w-full",children:[f&&(0,t.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-15 bg-gradient-to-r z-[1] from-background to-transparent pointer-events-none rounded-4 overflow-hidden"}),(0,t.jsx)("div",{ref:h,className:"overflow-x-auto scrollbar-hide whitespace-nowrap rounded-4 w-0 min-w-full",onScroll:N,children:(0,t.jsx)("div",{className:"flex gap-3 px-4 py-2",children:j.map(e=>A(e,"mobile-".concat(e.id)))})}),x&&(0,t.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-15 bg-gradient-to-l from-background to-transparent pointer-events-none"})]})]})}},389353:e=>{"use strict";e.s({default:()=>b});var t=e.i(290479),r=e.i(257140),i=e.i(397711),a=e.i(118246),n=e.i(373150),s=e.i(455578),o=e.i(221297),l=e.i(279791),c=e.i(663018),u=e.i(958962),d=e.i(885905),m=e.i(705222),p=e.i(461655),h=e.i(449097),f=e.i(997286),g=e.i(252390),x=e.i(732946),w=e.i(289702),y=e.i(831922),v=e.i(864945);let b=()=>{var e,b;let{user:C}=(0,d.useAuth)(),S=(0,i.useRouter)(),{track:T}=(0,g.default)(),{settings:k}=(0,h.useSettings)(),{height:L}=(0,m.default)(),{setInputText:j}=(0,f.useTeamInputText)(),[N,E]=(0,n.useState)(!1),_=(0,n.useRef)(null),[A,I]=(0,s.default)(),M=(0,n.useRef)(0),U=e=>{if(!e.types.includes("Files"))return!1;if(e.items&&e.items.length>0){for(let r=0;r<e.items.length;r++){let i=e.items[r];if("file"===i.kind){var t;if((null==(t=i.type)?void 0:t.startsWith("image/"))||i.type&&x.ALLOWED_FILE_TYPES.includes(i.type)||!i.type||""===i.type)return!0}}return!1}return!0},{createNote:D}=(0,p.default)({onSuccess:e=>{e&&(S.push("/b/".concat(e.id)),T("newCreateNoteClicked"))},onError:e=>{E(!1)}}),[P,R]=(0,a.useQueryState)("newNote",a.parseAsBoolean),[O,F]=(0,a.useQueryState)("referred",a.parseAsString),[G,W]=(0,a.useQueryState)("settingMembers",a.parseAsBoolean),[z,H]=(0,a.useQueryState)("settingRewards",a.parseAsBoolean),V=(null==C||null==(e=C.onboardingResponse)?void 0:e.length)?C.onboardingResponse[C.onboardingResponse.length-1].purpose:"unknown",K=(0,n.useCallback)(e=>{var t;if(!_.current||_.current.isEditorFocused()||e.ctrlKey||e.metaKey||e.altKey||"Tab"===e.key||"Enter"===e.key||"Escape"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Backspace"===e.key||"Delete"===e.key||(null==(t=e.key)?void 0:t.length)>1)return;let r=e.target;"INPUT"===r.tagName||"TEXTAREA"===r.tagName||"true"===r.contentEditable||r.closest('[contenteditable="true"]')||(e.preventDefault(),_.current.focusEditor(),_.current.insertText(e.key))},[]);(0,n.useEffect)(()=>(document.addEventListener("keydown",K),()=>{document.removeEventListener("keydown",K)}),[K]),(0,n.useEffect)(()=>{O&&C&&(T("email_CTA_click",{email:O,user_type:V}),F(null),P&&(E(!0),D(),R(null)),G&&(window.location.href="/settings/members",W(null)),z&&C&&(window.location.href="/settings/referrals",H(null)))},[P,O,C,V,G,z]);let B=(0,n.useCallback)(e=>{e.preventDefault(),U(e.dataTransfer)&&_.current&&(M.current++,_.current.setIsDragging(!0))},[]),q=(0,n.useCallback)(e=>{e.preventDefault(),M.current--,M.current<=0&&_.current&&(M.current=0,_.current.setIsDragging(!1))},[]),Z=(0,n.useCallback)(e=>{e.preventDefault(),U(e.dataTransfer)&&_.current&&_.current.setIsDragging(!0)},[]),$=(0,n.useCallback)(e=>{e.preventDefault(),M.current=0,_.current&&_.current.setIsDragging(!1)},[]);return N?(0,t.jsx)(c.Loading,{}):(0,t.jsx)(o.default.Provider,{initialValue:{isTeam:!!(null==C||null==(b=C.teamsMemberOf)?void 0:b.some(e=>"ACTIVE"===e.status)),mode:{type:"full-chat-library"}},children:(0,t.jsx)("div",{className:"h-full w-full",onDragEnter:B,onDragLeave:q,onDragOver:Z,onDrop:$,children:(0,t.jsxs)("div",{className:"max-w-[44rem] w-full p-10 pt-20 flex flex-col gap-10 mx-auto pb-24 relative",children:[(0,t.jsx)("div",{className:(0,w.cn)("flex-col md:flex items-center justify-center mx-auto",L<750&&"max-md:pt-24"),children:(0,t.jsx)(u.AnaraIcon,{className:"w-[32px] h-[32px] text-border"})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(y.default,{ref:_}),(0,t.jsxs)("div",{className:"mt-28 space-y-12 w-full",children:[(0,t.jsx)(v.default,{onPromptClick:e=>{var t;j(e),T("landing_prompt_clicked",{prompt:e,action:"trigger_autocomplete"});let i=(0,r.nanoid)(),a=new URLSearchParams({model:k.modelName,maxLength:(null==(t=k.maxLength)?void 0:t.toString())||"4000",mode:"full-chat-library"});S.prefetch("/b/".concat(i,"?").concat(a.toString(),"&chatId=").concat(i))},getEditor:()=>{var e;return null==(e=_.current)?void 0:e.getEditor()},onCreateNote:()=>{C&&(T("landing_prompt_clicked",{prompt:"create_note",action:"create_note"}),D(void 0))}}),(0,t.jsx)(l.default,{})]})]})]})})})}},622464:e=>{"use strict";e.s({Success:()=>d});var t=e.i(238635),r=e.i(608294),i=e.i(397711),a=e.i(373150),n=e.i(987395),s=e.i(885905),o=e.i(252390),l=e.i(437194),c=e.i(814733),u=e.i(523949);let d=()=>{let e=(0,i.useRouter)(),d=(0,i.useSearchParams)(),m=(0,i.usePathname)(),p=(0,r.useSetAtom)(n.showRewardBannerAtom),{track:h}=(0,o.default)(),{user:f}=(0,s.useAuth)(),g=c.api.useUtils();return(0,a.useEffect)(()=>{let r,i=null==d?void 0:d.get("checkout_complete"),a=null==d?void 0:d.get("plan"),n=null==d?void 0:d.get("billing_interval"),s=null==d?void 0:d.get("session_id");if("true"===i&&a&&n){h("checkout_completed",{plan:a,billing_interval:n,checkout_complete:i}),p(!1),(null==f?void 0:f.email)&&(r=setTimeout(()=>{g.user.byEmail.invalidate(f.email)},5e3)),window.gtag&&window.gtag("event","conversion",{send_to:"AW-16774945281/gN0YCLSBveoZEIG09b4-",value:"PREMIUM"===a?29:19*("PRO"===a),currency:"USD",transaction_id:s});try{let t=(0,u.getPrice)({plan:a,billingInterval:n});try{window.fbq("track","Purchase",{value:t,currency:"USD",contents:[{price:t,plan:a,billing_interval:n}]})}catch(e){}try{var o,c;null==(o=(c=window).rdt)||o.call(c,"track","Purchase",{value:t,currency:"USD",custom_data:{plan:a,billing_interval:n}})}catch(e){}try{(0,l.trackTikTokEvent)("Subscribe",{value:t,currency:"USD",contents:[{content_id:"".concat(a,"-").concat(n),price:t}]},{sendServer:!0})}catch(e){}let r=new URLSearchParams((null==d?void 0:d.toString())||"");r.delete("checkout_complete"),r.delete("plan"),r.delete("billing_interval"),r.delete("session_id");let i=r.toString()?"".concat(m||"","?").concat(r.toString()):m||"";e.replace(i)}catch(e){t.captureException("Error tracking purchase: ".concat(e))}}return()=>{r&&clearTimeout(r)}},[d,m,e,h,p,null==f?void 0:f.email,g.user.byEmail]),null}},195499:e=>{"use strict";e.s({useLandingTours:()=>s});var t=e.i(373150),r=e.i(185296),i=e.i(885905),a=e.i(814733),n=e.i(739087);let s=()=>{let{startTour:e}=(0,r.useTour)(),{isLoggedIn:s}=(0,i.useAuth)(),{data:o,isLoading:l}=a.api.tours.byUser.useQuery(void 0,{enabled:s}),c=null==o?void 0:o.find(e=>e.type===n.TourType.APP_LANDING_FIRST_VISIT),u=new Date("2025-08-04 09:50:00+03:00"),d=new Date("2025-08-11 19:49:00");(0,t.useEffect)(()=>{let t;if(Array.isArray(o)&&!l){if(null==c?void 0:c.completed){let r=new Date(null==c?void 0:c.createdAt);r<u&&(t=setTimeout(()=>{e(n.TourType.AGENT_FIRST_VISIT)},2e3)),r<d&&(t=setTimeout(()=>{e(n.TourType.AGENT_LANDING_FIRST_VISIT)},3e3))}else t=setTimeout(()=>{e(n.TourType.APP_LANDING_FIRST_VISIT)},2e3);return()=>clearTimeout(t)}},[c,u,l])}},67103:e=>{"use strict";e.s({default:()=>d});var t=e.i(290479),r=e.i(397711),i=e.i(373150),a=e.i(525094),n=e.i(663018),s=e.i(450807),o=e.i(389353),l=e.i(622464),c=e.i(195499);function u(){let e=(0,r.useSearchParams)(),n=(0,r.useRouter)(),{showUpgrade:u}=(0,s.useUpgrade)();return(0,c.useLandingTours)(),(0,i.useEffect)(()=>{"true"===(null==e?void 0:e.get("showUpsell"))&&(u("importLimit"),n.push("/new"))},[e,u,n]),(0,i.useEffect)(()=>{let r=null==e?void 0:e.get("error");if("true"===r)a.toast.error("Error importing file: document behind paywall"),n.push("/new");else if("max-accounts"===r){a.toast.error((0,t.jsxs)("span",{children:["Maximum number of accounts for this device reached. Please"," ",(0,t.jsx)("button",{className:"cursor-pointer underline",id:"intercom_support",children:"contact support"})," ","if this is a mistake."]}),{duration:7e3,id:"max-accounts-error"});let r=new URLSearchParams(null==e?void 0:e.toString());r.delete("error");let i=r.toString()?"?".concat(r.toString()):"";n.replace("/new".concat(i))}},[e,n]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.default,{}),(0,t.jsx)(l.Success,{})]})}let d=()=>(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)("div",{className:"fixed inset-0 flex justify-center items-center z-50 bg-background-primary",children:(0,t.jsx)("div",{className:"w-[56px] h-[56px]",children:(0,t.jsx)(n.LoadingSpinner,{variant:"screen",color:"gray"})})}),children:(0,t.jsx)(u,{})})}}]);

//# sourceMappingURL=b2e2455f230d0069.js.map